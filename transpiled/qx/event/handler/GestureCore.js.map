{
  "version": 3,
  "sources": [
    "/home/runner/work/hkollmann.mobilegrid/hkollmann.mobilegrid/node_modules/@qooxdoo/framework/source/class/qx/event/handler/GestureCore.js"
  ],
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "define",
    "extend",
    "Object",
    "implement",
    "core",
    "IDisposable",
    "statics",
    "TYPES",
    "GESTURE_EVENTS",
    "TAP_MAX_DISTANCE",
    "touch",
    "mouse",
    "pen",
    "DOUBLETAP_MAX_DISTANCE",
    "SWIPE_DIRECTION",
    "x",
    "y",
    "LONGTAP_TIME",
    "Environment",
    "get",
    "DOUBLETAP_TIME",
    "ROLL_FACTOR",
    "TOUCHPAD_ROLL_FACTOR",
    "TOUCHPAD_WHEEL_EVENTS_THRESHOLD",
    "TOUCHPAD_WHEEL_EVENTS_PERIOD",
    "TOUCHPAD_WHEEL_EVENTS_TIMEOUT",
    "construct",
    "target",
    "emitter",
    "__defaultTarget",
    "__emitter",
    "__gesture",
    "__lastTap",
    "__stopMomentum",
    "__momentum",
    "__rollEvents",
    "_initObserver",
    "members",
    "__eventName",
    "__primaryTarget",
    "__isMultiPointerGesture",
    "__initialAngle",
    "__rollImpulseId",
    "__initialDistance",
    "__rollEventsCountStart",
    "__rollEventsCount",
    "__touchPadDetectionPerformed",
    "__lastRollEventTime",
    "event",
    "handler",
    "GestureCore",
    "forEach",
    "gestureType",
    "qxWeb",
    "on",
    "checkAndFireGesture",
    "bind",
    "_onDblClick",
    "data",
    "type",
    "_fireRoll",
    "_stopObserver",
    "pointerType",
    "off",
    "domEvent",
    "bom",
    "Event",
    "getTarget",
    "gestureBegin",
    "gestureMove",
    "gestureFinish",
    "gestureCancel",
    "pointerId",
    "__stopLongTapTimer",
    "_hasIntermediaryHandler",
    "startTime",
    "Date",
    "getTime",
    "lastEventTime",
    "startX",
    "clientX",
    "startY",
    "clientY",
    "velocityX",
    "velocityY",
    "isTap",
    "isPrimary",
    "longTapTimer",
    "window",
    "setTimeout",
    "__fireLongTap",
    "__fireTrack",
    "keys",
    "length",
    "_calcAngle",
    "_calcDistance",
    "gesture",
    "oldClientX",
    "oldClientY",
    "__fireRotate",
    "__firePinch",
    "_isBelowTapMaxDistance",
    "$$gestureHandler",
    "parentNode",
    "__handleRollImpulse",
    "_fireEvent",
    "isDblTap",
    "limit",
    "now",
    "time",
    "lastTap",
    "isBelowDoubleTapDistance",
    "__isBelowDoubleTapDistance",
    "getPointerType",
    "isSameTarget",
    "isSameButton",
    "button",
    "swipe",
    "__getSwipeGesture",
    "stopMomentum",
    "id",
    "updateGestureTarget",
    "deltaX",
    "deltaY",
    "oldTimeoutId",
    "timeoutId",
    "Math",
    "abs",
    "getWindow",
    "startFactor",
    "AnimationFrame",
    "request",
    "lang",
    "Function",
    "round",
    "delta",
    "momentum",
    "pointerA",
    "pointerB",
    "atan2",
    "PI",
    "scale",
    "sqrt",
    "pow",
    "_getDeltaCoordinates",
    "maxDistance",
    "x1",
    "y1",
    "x2",
    "y2",
    "clazz",
    "inX",
    "inY",
    "axis",
    "evt",
    "dom",
    "Custom",
    "bubbles",
    "angle",
    "dispatchEvent",
    "currentTarget",
    "srcElement",
    "emit",
    "deltaCoordinates",
    "duration",
    "distance",
    "direction",
    "velocity",
    "__fireRollEvent",
    "rollFactor",
    "util",
    "Wheel",
    "getDelta",
    "__performAdaptativeRollScrolling",
    "IS_TOUCHPAD",
    "reLength",
    "i",
    "__endTouchPadDetection",
    "_isTouchPadDetectionEnabled",
    "detectionTimeout",
    "Timer",
    "once",
    "push",
    "clearTimeout",
    "dispose"
  ],
  "mappings": "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",
  "sourcesContent": [
    "/* ************************************************************************\n\n   qooxdoo - the new era of web development\n\n   http://qooxdoo.org\n\n   Copyright:\n     2014 1&1 Internet AG, Germany, http://www.1und1.de\n\n   License:\n     MIT: https://opensource.org/licenses/MIT\n     See the LICENSE file in the project's top-level directory for details.\n\n   Authors:\n     * Christopher Zuendorf (czuendorf)\n     * Daniel Wagner (danielwagner)\n\n************************************************************************ */\n\n/**\n * Listens for (native or synthetic) pointer events and fires events\n * for gestures like \"tap\" or \"swipe\"\n */\nqx.Bootstrap.define(\"qx.event.handler.GestureCore\", {\n  extend: Object,\n  implement: [qx.core.IDisposable],\n\n  statics: {\n    TYPES: [\n      \"tap\",\n      \"swipe\",\n      \"longtap\",\n      \"dbltap\",\n      \"track\",\n      \"trackstart\",\n      \"trackend\",\n      \"rotate\",\n      \"pinch\",\n      \"roll\"\n    ],\n\n    GESTURE_EVENTS: [\n      \"gesturebegin\",\n      \"gesturefinish\",\n      \"gesturemove\",\n      \"gesturecancel\"\n    ],\n\n    /** @type {Map} Maximum distance between a pointer-down and pointer-up event, values are configurable */\n    TAP_MAX_DISTANCE: { touch: 40, mouse: 5, pen: 20 }, // values are educated guesses\n\n    /** @type {Map} Maximum distance between two subsequent taps, values are configurable */\n    DOUBLETAP_MAX_DISTANCE: { touch: 10, mouse: 4, pen: 10 }, // values are educated guesses\n\n    /** @type {Map} The direction of a swipe relative to the axis */\n    SWIPE_DIRECTION: {\n      x: [\"left\", \"right\"],\n      y: [\"up\", \"down\"]\n    },\n\n    /**\n     * @type {Integer} The time delta in milliseconds to fire a long tap event.\n     */\n    LONGTAP_TIME: qx.core.Environment.get(\"device.touch\") ? 500 : 99999,\n\n    /**\n     * @type {Integer} Maximum time between two tap events that will still trigger a\n     * dbltap event.\n     */\n    DOUBLETAP_TIME: 500,\n\n    /**\n     * @type {Integer} Factor which is used for adapting the delta of the mouse wheel\n     * event to the roll events,\n     */\n    ROLL_FACTOR: 18,\n\n    /**\n     * @type {Integer} Factor which is used for adapting the delta of the touchpad gesture\n     * event to the roll events,\n     */\n    TOUCHPAD_ROLL_FACTOR: 1,\n\n    /**\n     * @type {Integer} Minimum number of wheel events to receive during the\n     * TOUCHPAD_WHEEL_EVENTS_PERIOD to detect a touchpad.\n     */\n    TOUCHPAD_WHEEL_EVENTS_THRESHOLD: 10,\n\n    /**\n     * @type {Integer} Period (in ms) during which the wheel events are counted in order\n     * to detect a touchpad.\n     */\n    TOUCHPAD_WHEEL_EVENTS_PERIOD: 100,\n\n    /**\n     * @type {Integer} Timeout (in ms) after which the touchpad detection is reset if no wheel\n     * events are received in the meantime.\n     */\n    TOUCHPAD_WHEEL_EVENTS_TIMEOUT: 5000\n  },\n\n  /**\n   * @param target {Element} DOM Element that should fire gesture events\n   * @param emitter {qx.event.Emitter?} Event emitter (used if dispatchEvent\n   * is not supported, e.g. in IE8)\n   */\n  construct(target, emitter) {\n    this.__defaultTarget = target;\n    this.__emitter = emitter;\n    this.__gesture = {};\n    this.__lastTap = {};\n    this.__stopMomentum = {};\n    this.__momentum = {};\n    this.__rollEvents = [];\n    this._initObserver();\n  },\n\n  members: {\n    __defaultTarget: null,\n    __emitter: null,\n    __gesture: null,\n    __eventName: null,\n    __primaryTarget: null,\n    __isMultiPointerGesture: null,\n    __initialAngle: null,\n    __lastTap: null,\n    __rollImpulseId: null,\n    __stopMomentum: null,\n    __initialDistance: null,\n    __momentum: null,\n    __rollEvents: null,\n    __rollEventsCountStart: 0,\n    __rollEventsCount: 0,\n    __touchPadDetectionPerformed: false,\n    __lastRollEventTime: 0,\n\n    /**\n     * Register pointer event listeners\n     */\n    _initObserver() {\n      qx.event.handler.GestureCore.GESTURE_EVENTS.forEach(\n        function (gestureType) {\n          qxWeb(this.__defaultTarget).on(\n            gestureType,\n            this.checkAndFireGesture,\n            this\n          );\n        }.bind(this)\n      );\n\n      if (\n        qx.core.Environment.get(\"engine.name\") == \"mshtml\" &&\n        qx.core.Environment.get(\"browser.documentmode\") < 9\n      ) {\n        qxWeb(this.__defaultTarget).on(\"dblclick\", this._onDblClick, this);\n      }\n\n      // list to wheel events\n      var data = qx.core.Environment.get(\"event.mousewheel\");\n      qxWeb(data.target).on(data.type, this._fireRoll, this);\n    },\n\n    /**\n     * Remove native pointer event listeners.\n     */\n    _stopObserver() {\n      qx.event.handler.GestureCore.GESTURE_EVENTS.forEach(\n        function (pointerType) {\n          qxWeb(this.__defaultTarget).off(\n            pointerType,\n            this.checkAndFireGesture,\n            this\n          );\n        }.bind(this)\n      );\n\n      if (\n        qx.core.Environment.get(\"engine.name\") == \"mshtml\" &&\n        qx.core.Environment.get(\"browser.documentmode\") < 9\n      ) {\n        qxWeb(this.__defaultTarget).off(\"dblclick\", this._onDblClick, this);\n      }\n\n      var data = qx.core.Environment.get(\"event.mousewheel\");\n      qxWeb(data.target).off(data.type, this._fireRoll, this);\n    },\n\n    /**\n     * Checks if a gesture was made and fires the gesture event.\n     *\n     * @param domEvent {qx.event.type.Pointer} DOM event\n     * @param type {String ? null} type of the event\n     * @param target {Element ? null} event target\n     */\n    checkAndFireGesture(domEvent, type, target) {\n      if (!type) {\n        type = domEvent.type;\n      }\n\n      if (!target) {\n        target = qx.bom.Event.getTarget(domEvent);\n      }\n\n      if (type == \"gesturebegin\") {\n        this.gestureBegin(domEvent, target);\n      } else if (type == \"gesturemove\") {\n        this.gestureMove(domEvent, target);\n      } else if (type == \"gesturefinish\") {\n        this.gestureFinish(domEvent, target);\n      } else if (type == \"gesturecancel\") {\n        this.gestureCancel(domEvent.pointerId);\n      }\n    },\n\n    /**\n     * Helper method for gesture start.\n     *\n     * @param domEvent {Event} DOM event\n     * @param target {Element} event target\n     */\n    gestureBegin(domEvent, target) {\n      if (this.__gesture[domEvent.pointerId]) {\n        this.__stopLongTapTimer(this.__gesture[domEvent.pointerId]);\n        delete this.__gesture[domEvent.pointerId];\n      }\n\n      /*\n        If the dom event's target or one of its ancestors have\n        a gesture handler, we don't need to fire the gesture again\n        since it bubbles.\n       */\n      if (this._hasIntermediaryHandler(target)) {\n        return;\n      }\n\n      this.__gesture[domEvent.pointerId] = {\n        startTime: new Date().getTime(),\n        lastEventTime: new Date().getTime(),\n        startX: domEvent.clientX,\n        startY: domEvent.clientY,\n        clientX: domEvent.clientX,\n        clientY: domEvent.clientY,\n        velocityX: 0,\n        velocityY: 0,\n        target: target,\n        isTap: true,\n        isPrimary: domEvent.isPrimary,\n        longTapTimer: window.setTimeout(\n          this.__fireLongTap.bind(this, domEvent, target),\n          qx.event.handler.GestureCore.LONGTAP_TIME\n        )\n      };\n\n      if (domEvent.isPrimary) {\n        this.__isMultiPointerGesture = false;\n        this.__primaryTarget = target;\n        this.__fireTrack(\"trackstart\", domEvent, target);\n      } else {\n        this.__isMultiPointerGesture = true;\n        if (Object.keys(this.__gesture).length === 2) {\n          this.__initialAngle = this._calcAngle();\n          this.__initialDistance = this._calcDistance();\n        }\n      }\n    },\n\n    /**\n     * Helper method for gesture move.\n     *\n     * @param domEvent {Event} DOM event\n     * @param target {Element} event target\n     */\n    gestureMove(domEvent, target) {\n      var gesture = this.__gesture[domEvent.pointerId];\n\n      if (gesture) {\n        var oldClientX = gesture.clientX;\n        var oldClientY = gesture.clientY;\n\n        gesture.clientX = domEvent.clientX;\n        gesture.clientY = domEvent.clientY;\n        gesture.lastEventTime = new Date().getTime();\n\n        if (oldClientX) {\n          gesture.velocityX = gesture.clientX - oldClientX;\n        }\n        if (oldClientY) {\n          gesture.velocityY = gesture.clientY - oldClientY;\n        }\n\n        if (Object.keys(this.__gesture).length === 2) {\n          this.__fireRotate(domEvent, gesture.target);\n          this.__firePinch(domEvent, gesture.target);\n        }\n\n        if (!this.__isMultiPointerGesture) {\n          this.__fireTrack(\"track\", domEvent, gesture.target);\n          this._fireRoll(domEvent, \"touch\", gesture.target);\n        }\n\n        // abort long tap timer if the distance is too big\n        if (gesture.isTap) {\n          gesture.isTap = this._isBelowTapMaxDistance(domEvent);\n          if (!gesture.isTap) {\n            this.__stopLongTapTimer(gesture);\n          }\n        }\n      }\n    },\n\n    /**\n     * Checks if a DOM element located between the target of a gesture\n     * event and the element this handler is attached to has a gesture\n     * handler of its own.\n     *\n     * @param target {Element} The gesture event's target\n     * @return {Boolean}\n     */\n    _hasIntermediaryHandler(target) {\n      while (target && target !== this.__defaultTarget) {\n        if (target.$$gestureHandler) {\n          return true;\n        }\n        target = target.parentNode;\n      }\n      return false;\n    },\n\n    /**\n     * Helper method for gesture end.\n     *\n     * @param domEvent {Event} DOM event\n     * @param target {Element} event target\n     */\n    gestureFinish(domEvent, target) {\n      // If no start position is available for this pointerup event, cancel gesture recognition.\n      if (!this.__gesture[domEvent.pointerId]) {\n        return;\n      }\n\n      var gesture = this.__gesture[domEvent.pointerId];\n      // delete the long tap\n      this.__stopLongTapTimer(gesture);\n\n      /*\n        If the dom event's target or one of its ancestors have\n        a gesture handler, we don't need to fire the gesture again\n        since it bubbles.\n       */\n      if (this._hasIntermediaryHandler(target)) {\n        return;\n      }\n\n      // always start the roll impulse on the original target\n      this.__handleRollImpulse(\n        gesture.velocityX,\n        gesture.velocityY,\n        domEvent,\n        gesture.target\n      );\n\n      this.__fireTrack(\"trackend\", domEvent, gesture.target);\n\n      if (gesture.isTap) {\n        if (target !== gesture.target) {\n          delete this.__gesture[domEvent.pointerId];\n          return;\n        }\n\n        this._fireEvent(domEvent, \"tap\", domEvent.target || target);\n\n        var isDblTap = false;\n        if (Object.keys(this.__lastTap).length > 0) {\n          // delete old tap entries\n          var limit = Date.now() - qx.event.handler.GestureCore.DOUBLETAP_TIME;\n          for (var time in this.__lastTap) {\n            if (time < limit) {\n              delete this.__lastTap[time];\n            } else {\n              var lastTap = this.__lastTap[time];\n              var isBelowDoubleTapDistance = this.__isBelowDoubleTapDistance(\n                lastTap.x,\n                lastTap.y,\n                domEvent.clientX,\n                domEvent.clientY,\n                domEvent.getPointerType()\n              );\n\n              var isSameTarget = lastTap.target === (domEvent.target || target);\n              var isSameButton = lastTap.button === domEvent.button;\n\n              if (isBelowDoubleTapDistance && isSameButton && isSameTarget) {\n                isDblTap = true;\n                delete this.__lastTap[time];\n                this._fireEvent(domEvent, \"dbltap\", domEvent.target || target);\n              }\n            }\n          }\n        }\n\n        if (!isDblTap) {\n          this.__lastTap[Date.now()] = {\n            x: domEvent.clientX,\n            y: domEvent.clientY,\n            target: domEvent.target || target,\n            button: domEvent.button\n          };\n        }\n      } else if (!this._isBelowTapMaxDistance(domEvent)) {\n        var swipe = this.__getSwipeGesture(domEvent, target);\n        if (swipe) {\n          domEvent.swipe = swipe;\n          this._fireEvent(domEvent, \"swipe\", gesture.target || target);\n        }\n      }\n\n      delete this.__gesture[domEvent.pointerId];\n    },\n\n    /**\n     * Stops the momentum scrolling currently running.\n     *\n     * @param id {Integer} The timeoutId of a 'roll' event\n     */\n    stopMomentum(id) {\n      this.__stopMomentum[id] = true;\n    },\n\n    /**\n     * Cancels the gesture if running.\n     * @param id {Number} The pointer Id.\n     */\n    gestureCancel(id) {\n      if (this.__gesture[id]) {\n        this.__stopLongTapTimer(this.__gesture[id]);\n        delete this.__gesture[id];\n      }\n      if (this.__momentum[id]) {\n        this.stopMomentum(this.__momentum[id]);\n        delete this.__momentum[id];\n      }\n    },\n\n    /**\n     * Update the target of a running gesture. This is used in virtual widgets\n     * when the DOM element changes.\n     *\n     * @param id {String} The pointer id.\n     * @param target {Element} The new target element.\n     * @internal\n     */\n    updateGestureTarget(id, target) {\n      this.__gesture[id].target = target;\n    },\n\n    /**\n     * Method which will be called recursively to provide a momentum scrolling.\n     * @param deltaX {Number} The last offset in X direction\n     * @param deltaY {Number} The last offset in Y direction\n     * @param domEvent {Event} The original gesture event\n     * @param target {Element} The target of the momentum roll events\n     * @param time {Number ?} The time in ms between the last two calls\n     */\n    __handleRollImpulse(deltaX, deltaY, domEvent, target, time) {\n      var oldTimeoutId = domEvent.timeoutId;\n      if (!time && this.__momentum[domEvent.pointerId]) {\n        // new roll impulse started, stop the old one\n        this.stopMomentum(this.__momentum[domEvent.pointerId]);\n      }\n      // do nothing if we don't need to scroll\n      if (\n        (Math.abs(deltaY) < 1 && Math.abs(deltaX) < 1) ||\n        this.__stopMomentum[oldTimeoutId] ||\n        !this.getWindow()\n      ) {\n        delete this.__stopMomentum[oldTimeoutId];\n        delete this.__momentum[domEvent.pointerId];\n        return;\n      }\n\n      if (!time) {\n        time = 1;\n        var startFactor = 2.8;\n        deltaY = deltaY / startFactor;\n        deltaX = deltaX / startFactor;\n      }\n      time += 0.0006;\n\n      deltaY = deltaY / time;\n      deltaX = deltaX / time;\n\n      // set up a new timer with the new delta\n      var timeoutId = qx.bom.AnimationFrame.request(\n        qx.lang.Function.bind(\n          function (deltaX, deltaY, domEvent, target, time) {\n            this.__handleRollImpulse(deltaX, deltaY, domEvent, target, time);\n          },\n          this,\n          deltaX,\n          deltaY,\n          domEvent,\n          target,\n          time\n        )\n      );\n\n      deltaX = Math.round(deltaX * 100) / 100;\n      deltaY = Math.round(deltaY * 100) / 100;\n\n      // scroll the desired new delta\n      domEvent.delta = {\n        x: -deltaX,\n        y: -deltaY\n      };\n\n      domEvent.momentum = true;\n      domEvent.timeoutId = timeoutId;\n      this.__momentum[domEvent.pointerId] = timeoutId;\n      this._fireEvent(domEvent, \"roll\", domEvent.target || target);\n    },\n\n    /**\n     * Calculates the angle of the primary and secondary pointer.\n     * @return {Number} the rotation angle of the 2 pointers.\n     */\n    _calcAngle() {\n      var pointerA = null;\n      var pointerB = null;\n\n      for (var pointerId in this.__gesture) {\n        var gesture = this.__gesture[pointerId];\n        if (pointerA === null) {\n          pointerA = gesture;\n        } else {\n          pointerB = gesture;\n        }\n      }\n\n      var x = pointerA.clientX - pointerB.clientX;\n      var y = pointerA.clientY - pointerB.clientY;\n\n      return (360 + Math.atan2(y, x) * (180 / Math.PI)) % 360;\n    },\n\n    /**\n     * Calculates the scaling distance between two pointers.\n     * @return {Number} the calculated distance.\n     */\n    _calcDistance() {\n      var pointerA = null;\n      var pointerB = null;\n\n      for (var pointerId in this.__gesture) {\n        var gesture = this.__gesture[pointerId];\n        if (pointerA === null) {\n          pointerA = gesture;\n        } else {\n          pointerB = gesture;\n        }\n      }\n\n      var scale = Math.sqrt(\n        Math.pow(pointerA.clientX - pointerB.clientX, 2) +\n          Math.pow(pointerA.clientY - pointerB.clientY, 2)\n      );\n\n      return scale;\n    },\n\n    /**\n     * Checks if the distance between the x/y coordinates of DOM event\n     * exceeds TAP_MAX_DISTANCE and returns the result.\n     *\n     * @param domEvent {Event} The DOM event from the browser.\n     * @return {Boolean|null} true if distance is below TAP_MAX_DISTANCE.\n     */\n    _isBelowTapMaxDistance(domEvent) {\n      var delta = this._getDeltaCoordinates(domEvent);\n      var maxDistance =\n        qx.event.handler.GestureCore.TAP_MAX_DISTANCE[\n          domEvent.getPointerType()\n        ];\n\n      if (!delta) {\n        return null;\n      }\n\n      return (\n        Math.abs(delta.x) <= maxDistance && Math.abs(delta.y) <= maxDistance\n      );\n    },\n\n    /**\n     * Checks if the distance between the x1/y1 and x2/y2 is\n     * below the TAP_MAX_DISTANCE and returns the result.\n     *\n     * @param x1 {Number} The x position of point one.\n     * @param y1 {Number} The y position of point one.\n     * @param x2 {Number} The x position of point two.\n     * @param y2 {Number} The y position of point two.\n     * @param type {String} The pointer type e.g. \"mouse\"\n     * @return {Boolean} <code>true</code>, if points are in range\n     */\n    __isBelowDoubleTapDistance(x1, y1, x2, y2, type) {\n      var clazz = qx.event.handler.GestureCore;\n\n      var inX = Math.abs(x1 - x2) < clazz.DOUBLETAP_MAX_DISTANCE[type];\n      var inY = Math.abs(y1 - y2) < clazz.DOUBLETAP_MAX_DISTANCE[type];\n\n      return inX && inY;\n    },\n\n    /**\n     * Calculates the delta coordinates in relation to the position on <code>pointerstart</code> event.\n     * @param domEvent {Event} The DOM event from the browser.\n     * @return {Map} containing the deltaX as x, and deltaY as y.\n     */\n    _getDeltaCoordinates(domEvent) {\n      var gesture = this.__gesture[domEvent.pointerId];\n      if (!gesture) {\n        return null;\n      }\n\n      var deltaX = domEvent.clientX - gesture.startX;\n      var deltaY = domEvent.clientY - gesture.startY;\n\n      var axis = \"x\";\n      if (Math.abs(deltaX / deltaY) < 1) {\n        axis = \"y\";\n      }\n\n      return {\n        x: deltaX,\n        y: deltaY,\n        axis: axis\n      };\n    },\n\n    /**\n     * Fire a gesture event with the given parameters\n     *\n     * @param domEvent {Event} DOM event\n     * @param type {String} type of the event\n     * @param target {Element ? null} event target\n     * @return {qx.Promise?} a promise, if one or more of the event handlers returned a promise\n     */\n    _fireEvent(domEvent, type, target) {\n      // The target may have been removed, e.g. menu hide on tap\n      if (!this.__defaultTarget) {\n        return;\n      }\n      var evt;\n      if (qx.core.Environment.get(\"event.dispatchevent\")) {\n        evt = new qx.event.type.dom.Custom(type, domEvent, {\n          bubbles: true,\n          swipe: domEvent.swipe,\n          scale: domEvent.scale,\n          angle: domEvent.angle,\n          delta: domEvent.delta,\n          pointerType: domEvent.pointerType,\n          momentum: domEvent.momentum\n        });\n\n        return target.dispatchEvent(evt);\n      } else if (this.__emitter) {\n        evt = new qx.event.type.dom.Custom(type, domEvent, {\n          target: this.__defaultTarget,\n          currentTarget: this.__defaultTarget,\n          srcElement: this.__defaultTarget,\n          swipe: domEvent.swipe,\n          scale: domEvent.scale,\n          angle: domEvent.angle,\n          delta: domEvent.delta,\n          pointerType: domEvent.pointerType,\n          momentum: domEvent.momentum\n        });\n\n        this.__emitter.emit(type, domEvent);\n      }\n    },\n\n    /**\n     * Fire \"tap\" and \"dbltap\" events after a native \"dblclick\"\n     * event to fix IE 8's broken mouse event sequence.\n     *\n     * @param domEvent {Event} dblclick event\n     */\n    _onDblClick(domEvent) {\n      var target = qx.bom.Event.getTarget(domEvent);\n      this._fireEvent(domEvent, \"tap\", target);\n      this._fireEvent(domEvent, \"dbltap\", target);\n    },\n\n    /**\n     * Returns the swipe gesture when the user performed a swipe.\n     *\n     * @param domEvent {Event} DOM event\n     * @param target {Element} event target\n     * @return {Map|null} returns the swipe data when the user performed a swipe, null if the gesture was no swipe.\n     */\n    __getSwipeGesture(domEvent, target) {\n      var gesture = this.__gesture[domEvent.pointerId];\n      if (!gesture) {\n        return null;\n      }\n\n      var clazz = qx.event.handler.GestureCore;\n      var deltaCoordinates = this._getDeltaCoordinates(domEvent);\n      var duration = new Date().getTime() - gesture.startTime;\n      var axis =\n        Math.abs(deltaCoordinates.x) >= Math.abs(deltaCoordinates.y)\n          ? \"x\"\n          : \"y\";\n      var distance = deltaCoordinates[axis];\n      var direction = clazz.SWIPE_DIRECTION[axis][distance < 0 ? 0 : 1];\n      var velocity = duration !== 0 ? distance / duration : 0;\n\n      var swipe = {\n        startTime: gesture.startTime,\n        duration: duration,\n        axis: axis,\n        direction: direction,\n        distance: distance,\n        velocity: velocity\n      };\n\n      return swipe;\n    },\n\n    /**\n     * Fires a track event.\n     *\n     * @param type {String} the track type\n     * @param domEvent {Event} DOM event\n     * @param target {Element} event target\n     */\n    __fireTrack(type, domEvent, target) {\n      domEvent.delta = this._getDeltaCoordinates(domEvent);\n      this._fireEvent(domEvent, type, domEvent.target || target);\n    },\n\n    /**\n     * Fires a roll event.\n     *\n     * @param domEvent {Event} DOM event\n     * @param target {Element} event target\n     * @param rollFactor {Integer} the roll factor to apply\n     */\n    __fireRollEvent(domEvent, target, rollFactor) {\n      domEvent.delta = {\n        x: qx.util.Wheel.getDelta(domEvent, \"x\") * rollFactor,\n        y: qx.util.Wheel.getDelta(domEvent, \"y\") * rollFactor\n      };\n\n      domEvent.delta.axis =\n        Math.abs(domEvent.delta.x / domEvent.delta.y) < 1 ? \"y\" : \"x\";\n      domEvent.pointerType = \"wheel\";\n      this._fireEvent(domEvent, \"roll\", domEvent.target || target);\n    },\n\n    /**\n     * Triggers the adaptative roll scrolling.\n     *\n     * @param target {Element} event target\n     */\n    __performAdaptativeRollScrolling(target) {\n      var rollFactor = qx.event.handler.GestureCore.ROLL_FACTOR;\n      if (qx.util.Wheel.IS_TOUCHPAD) {\n        // The domEvent was generated by a touchpad\n        rollFactor = qx.event.handler.GestureCore.TOUCHPAD_ROLL_FACTOR;\n      }\n      this.__lastRollEventTime = new Date().getTime();\n      var reLength = this.__rollEvents.length;\n      for (var i = 0; i < reLength; i++) {\n        var domEvent = this.__rollEvents[i];\n        this.__fireRollEvent(domEvent, target, rollFactor);\n      }\n      this.__rollEvents = [];\n    },\n\n    /**\n     * Ends touch pad detection process.\n     */\n    __endTouchPadDetection() {\n      if (\n        this.__rollEvents.length >\n        qx.event.handler.GestureCore.TOUCHPAD_WHEEL_EVENTS_THRESHOLD\n      ) {\n        qx.util.Wheel.IS_TOUCHPAD = true;\n      } else {\n        qx.util.Wheel.IS_TOUCHPAD = false;\n      }\n      if (qx.core.Environment.get(\"qx.debug.touchpad.detection\")) {\n        qx.log.Logger.debug(this, \"IS_TOUCHPAD : \" + qx.util.Wheel.IS_TOUCHPAD);\n      }\n      this.__touchPadDetectionPerformed = true;\n    },\n\n    /**\n     * Is touchpad detection enabled ? Default implementation activates it only for Mac OS after Sierra (>= 10.12).\n     * @return {boolean} true if touchpad detection should occur.\n     * @internal\n     */\n    _isTouchPadDetectionEnabled() {\n      return (\n        qx.core.Environment.get(\"os.name\") == \"osx\" &&\n        qx.core.Environment.get(\"os.version\") >= 10.12\n      );\n    },\n\n    /**\n     * Fires a roll event after determining the roll factor to apply. Mac OS Sierra (10.12+)\n     * introduces a lot more wheel events fired from the trackpad, so the roll factor to be applied\n     * has to be reduced in order to make the scrolling less sensitive.\n     *\n     * @param domEvent {Event} DOM event\n     * @param type {String} The type of the dom event\n     * @param target {Element} event target\n     */\n    _fireRoll(domEvent, type, target) {\n      var now;\n      var detectionTimeout;\n      if (domEvent.type === qx.core.Environment.get(\"event.mousewheel\").type) {\n        if (this._isTouchPadDetectionEnabled()) {\n          now = new Date().getTime();\n          detectionTimeout =\n            qx.event.handler.GestureCore.TOUCHPAD_WHEEL_EVENTS_TIMEOUT;\n          if (\n            this.__lastRollEventTime > 0 &&\n            now - this.__lastRollEventTime > detectionTimeout\n          ) {\n            // The detection timeout was reached. A new detection step should occur.\n            this.__touchPadDetectionPerformed = false;\n            this.__rollEvents = [];\n            this.__lastRollEventTime = 0;\n          }\n          if (!this.__touchPadDetectionPerformed) {\n            // We are into a detection session. We count the events so that we can decide if\n            // they were fired by a real mouse wheel or a touchpad. Just swallow them until the\n            // detection period is over.\n            if (this.__rollEvents.length === 0) {\n              // detection starts\n              this.__rollEventsCountStart = now;\n              qx.event.Timer.once(\n                function () {\n                  if (!this.__touchPadDetectionPerformed) {\n                    // There were not enough events during the TOUCHPAD_WHEEL_EVENTS_PERIOD to actually\n                    // trigger a scrolling. Trigger it manually.\n                    this.__endTouchPadDetection();\n                    this.__performAdaptativeRollScrolling(target);\n                  }\n                },\n                this,\n                qx.event.handler.GestureCore.TOUCHPAD_WHEEL_EVENTS_PERIOD + 50\n              );\n            }\n            this.__rollEvents.push(domEvent);\n            this.__rollEventsCount++;\n            if (\n              now - this.__rollEventsCountStart >\n              qx.event.handler.GestureCore.TOUCHPAD_WHEEL_EVENTS_PERIOD\n            ) {\n              this.__endTouchPadDetection();\n            }\n          }\n          if (this.__touchPadDetectionPerformed) {\n            if (this.__rollEvents.length === 0) {\n              this.__rollEvents.push(domEvent);\n            }\n            // Detection is done. We can now decide the roll factor to apply to the delta.\n            // Default to a real mouse wheel event as opposed to a touchpad one.\n            this.__performAdaptativeRollScrolling(target);\n          }\n        } else {\n          this.__fireRollEvent(\n            domEvent,\n            target,\n            qx.event.handler.GestureCore.ROLL_FACTOR\n          );\n        }\n      } else {\n        var gesture = this.__gesture[domEvent.pointerId];\n        domEvent.delta = {\n          x: -gesture.velocityX,\n          y: -gesture.velocityY,\n          axis: Math.abs(gesture.velocityX / gesture.velocityY) < 1 ? \"y\" : \"x\"\n        };\n\n        this._fireEvent(domEvent, \"roll\", domEvent.target || target);\n      }\n    },\n\n    /**\n     * Fires a rotate event.\n     *\n     * @param domEvent {Event} DOM event\n     * @param target {Element} event target\n     */\n    __fireRotate(domEvent, target) {\n      if (!domEvent.isPrimary) {\n        var angle = this._calcAngle();\n        domEvent.angle = Math.round((angle - this.__initialAngle) % 360);\n        this._fireEvent(domEvent, \"rotate\", this.__primaryTarget);\n      }\n    },\n\n    /**\n     * Fires a pinch event.\n     *\n     * @param domEvent {Event} DOM event\n     * @param target {Element} event target\n     */\n    __firePinch(domEvent, target) {\n      if (!domEvent.isPrimary) {\n        var distance = this._calcDistance();\n        var scale = distance / this.__initialDistance;\n        domEvent.scale = Math.round(scale * 100) / 100;\n        this._fireEvent(domEvent, \"pinch\", this.__primaryTarget);\n      }\n    },\n\n    /**\n     * Fires the long tap event.\n     *\n     * @param domEvent {Event} DOM event\n     * @param target {Element} event target\n     */\n    __fireLongTap(domEvent, target) {\n      var gesture = this.__gesture[domEvent.pointerId];\n      if (gesture) {\n        this._fireEvent(domEvent, \"longtap\", domEvent.target || target);\n        gesture.longTapTimer = null;\n        gesture.isTap = false;\n      }\n    },\n\n    /**\n     * Stops the time for the long tap event.\n     * @param gesture {Map} Data may representing the gesture.\n     */\n    __stopLongTapTimer(gesture) {\n      if (gesture.longTapTimer) {\n        window.clearTimeout(gesture.longTapTimer);\n        gesture.longTapTimer = null;\n      }\n    },\n\n    /**\n     * Dispose the current instance\n     */\n    dispose() {\n      for (var gesture in this.__gesture) {\n        this.__stopLongTapTimer(gesture);\n      }\n\n      this._stopObserver();\n      this.__defaultTarget = this.__emitter = null;\n    }\n  }\n});\n"
  ]
}