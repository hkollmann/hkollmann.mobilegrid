{
  "version": 3,
  "sources": [
    "/home/runner/work/hkollmann.mobilegrid/hkollmann.mobilegrid/node_modules/@qooxdoo/framework/source/class/qx/event/handler/Focus.js"
  ],
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "core",
    "Object",
    "implement",
    "event",
    "IEventHandler",
    "IDisposable",
    "construct",
    "manager",
    "_manager",
    "_window",
    "getWindow",
    "_document",
    "document",
    "_root",
    "documentElement",
    "_body",
    "body",
    "Environment",
    "get",
    "parseFloat",
    "application",
    "Inline",
    "Init",
    "getApplication",
    "__needsScrollFix",
    "_initObserver",
    "properties",
    "active",
    "apply",
    "nullable",
    "focus",
    "statics",
    "PRIORITY",
    "Registration",
    "PRIORITY_NORMAL",
    "SUPPORTED_TYPES",
    "blur",
    "focusin",
    "focusout",
    "activate",
    "deactivate",
    "IGNORE_CAN_HANDLE",
    "FOCUSABLE_ELEMENTS",
    "select",
    "mshtml",
    "a",
    "button",
    "frame",
    "iframe",
    "img",
    "input",
    "object",
    "textarea",
    "gecko",
    "opera",
    "webkit",
    "members",
    "__onNativeMouseDownWrapper",
    "__onNativeMouseUpWrapper",
    "__onNativeFocusWrapper",
    "__onNativeBlurWrapper",
    "__onNativeDragGestureWrapper",
    "__onNativeSelectStartWrapper",
    "__onNativeFocusInWrapper",
    "__onNativeFocusOutWrapper",
    "__previousFocus",
    "__previousActive",
    "__down",
    "__up",
    "__relatedTarget",
    "canHandleEvent",
    "target",
    "type",
    "registerEvent",
    "capture",
    "unregisterEvent",
    "element",
    "window",
    "setTimeout",
    "selection",
    "bom",
    "Selection",
    "length",
    "createTextRange",
    "textRange",
    "moveStart",
    "value",
    "collapse",
    "ex",
    "setFocus",
    "setActive",
    "getActive",
    "resetActive",
    "getFocus",
    "resetFocus",
    "tryActivate",
    "__findActivatableElement",
    "__fireEvent",
    "related",
    "bubbles",
    "evt",
    "createEvent",
    "Focus",
    "dispatchEvent",
    "_windowFocused",
    "__doWindowBlur",
    "__doWindowFocus",
    "lang",
    "Function",
    "listener",
    "__onNativeMouseDown",
    "__onNativeMouseUp",
    "__onNativeFocus",
    "__onNativeBlur",
    "__onNativeDragGesture",
    "Event",
    "addNativeListener",
    "__onNativeFocusIn",
    "__onNativeFocusOut",
    "__onNativeSelectStart",
    "edge",
    "domEvent",
    "_stopObserver",
    "removeNativeListener",
    "GlobalError",
    "observeMethod",
    "getTarget",
    "__isSelectable",
    "preventDefault",
    "focusTarget",
    "__findFocusableElement",
    "selectionStart",
    "selectionEnd",
    "relatedTarget",
    "getRelatedTarget",
    "unselectable",
    "empty",
    "current",
    "__fixFocus",
    "offsetWidth",
    "undefined",
    "parentNode",
    "__getCorrectFocusTarget",
    "focusedElement",
    "nodeName",
    "toLowerCase",
    "isClass",
    "widget",
    "ui",
    "Widget",
    "getWidgetByElement",
    "textField",
    "getChildControl",
    "getContentElement",
    "getDomElement",
    "__isFocusable",
    "el",
    "index",
    "Attribute",
    "focusable",
    "handler",
    "tagName",
    "nodeType",
    "getAttribute",
    "orig",
    "node",
    "attr",
    "_applyActive",
    "old",
    "scrollTo",
    "_applyFocus",
    "destruct",
    "__mouseActive",
    "defer",
    "addHandler",
    "entry",
    "toUpperCase"
  ],
  "mappings": "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",
  "sourcesContent": [
    "/* ************************************************************************\n\n   qooxdoo - the new era of web development\n\n   http://qooxdoo.org\n\n   Copyright:\n     2007-2008 1&1 Internet AG, Germany, http://www.1und1.de\n\n   License:\n     MIT: https://opensource.org/licenses/MIT\n     See the LICENSE file in the project's top-level directory for details.\n\n   Authors:\n     * Sebastian Werner (wpbasti)\n     * Fabian Jakobs (fjakobs)\n     * Christian Hagendorn (chris_schmidt)\n\n************************************************************************ */\n\n/**\n * This handler is used to normalize all focus/activation requirements\n * and normalize all cross browser quirks in this area.\n *\n * Notes:\n *\n * * Webkit and Opera (before 9.5) do not support tabIndex for all elements\n * (See also: https://bugs.webkit.org/show_bug.cgi?id=7138)\n *\n * * TabIndex is normally 0, which means all naturally focusable elements are focusable.\n * * TabIndex > 0 means that the element is focusable and tabable\n * * TabIndex < 0 means that the element, even if naturally possible, is not focusable.\n *\n * NOTE: Instances of this class must be disposed of after use\n *\n * @use(qx.event.dispatch.DomBubbling)\n */\nqx.Class.define(\"qx.event.handler.Focus\", {\n  extend: qx.core.Object,\n  implement: [qx.event.IEventHandler, qx.core.IDisposable],\n\n  /*\n  *****************************************************************************\n     CONSTRUCTOR\n  *****************************************************************************\n  */\n\n  /**\n   * Create a new instance\n   *\n   * @param manager {qx.event.Manager} Event manager for the window to use\n   *\n   * @ignore(qx.application.Inline)\n   */\n  construct(manager) {\n    super();\n\n    // Define shorthands\n    this._manager = manager;\n    this._window = manager.getWindow();\n    this._document = this._window.document;\n    this._root = this._document.documentElement;\n    this._body = this._document.body;\n\n    if (\n      qx.core.Environment.get(\"os.name\") == \"ios\" &&\n      parseFloat(qx.core.Environment.get(\"os.version\")) > 6 &&\n      (!qx.application.Inline ||\n        !qx.core.Init.getApplication() instanceof qx.application.Inline)\n    ) {\n      this.__needsScrollFix = true;\n    }\n\n    // Initialize\n    this._initObserver();\n  },\n\n  /*\n  *****************************************************************************\n     PROPERTIES\n  *****************************************************************************\n  */\n\n  properties: {\n    /** The active DOM element */\n    active: {\n      apply: \"_applyActive\",\n      nullable: true\n    },\n\n    /** The focussed DOM element */\n    focus: {\n      apply: \"_applyFocus\",\n      nullable: true\n    }\n  },\n\n  /*\n  *****************************************************************************\n     STATICS\n  *****************************************************************************\n  */\n\n  statics: {\n    /** @type {Integer} Priority of this handler */\n    PRIORITY: qx.event.Registration.PRIORITY_NORMAL,\n\n    /** @type {Map} Supported event types */\n    SUPPORTED_TYPES: {\n      focus: 1,\n      blur: 1,\n      focusin: 1,\n      focusout: 1,\n      activate: 1,\n      deactivate: 1\n    },\n\n    /** @type {Integer} Whether the method \"canHandleEvent\" must be called */\n    IGNORE_CAN_HANDLE: true,\n\n    /**\n     * @type {Map} See: http://msdn.microsoft.com/en-us/library/ms534654(VS.85).aspx\n     */\n    FOCUSABLE_ELEMENTS: qx.core.Environment.select(\"engine.name\", {\n      mshtml: {\n        a: 1,\n        body: 1,\n        button: 1,\n        frame: 1,\n        iframe: 1,\n        img: 1,\n        input: 1,\n        object: 1,\n        select: 1,\n        textarea: 1\n      },\n\n      gecko: {\n        a: 1,\n        body: 1,\n        button: 1,\n        frame: 1,\n        iframe: 1,\n        img: 1,\n        input: 1,\n        object: 1,\n        select: 1,\n        textarea: 1\n      },\n\n      opera: {\n        button: 1,\n        input: 1,\n        select: 1,\n        textarea: 1\n      },\n\n      webkit: {\n        button: 1,\n        input: 1,\n        select: 1,\n        textarea: 1\n      }\n    })\n  },\n\n  /*\n  *****************************************************************************\n     MEMBERS\n  *****************************************************************************\n  */\n\n  members: {\n    __onNativeMouseDownWrapper: null,\n    __onNativeMouseUpWrapper: null,\n    __onNativeFocusWrapper: null,\n    __onNativeBlurWrapper: null,\n    __onNativeDragGestureWrapper: null,\n    __onNativeSelectStartWrapper: null,\n    __onNativeFocusInWrapper: null,\n    __onNativeFocusOutWrapper: null,\n    __previousFocus: null,\n    __previousActive: null,\n    __down: \"\",\n    __up: \"\",\n    __needsScrollFix: false,\n    __relatedTarget: null,\n\n    /*\n    ---------------------------------------------------------------------------\n      EVENT HANDLER INTERFACE\n    ---------------------------------------------------------------------------\n    */\n\n    // interface implementation\n    canHandleEvent(target, type) {},\n\n    // interface implementation\n    registerEvent(target, type, capture) {\n      // Nothing needs to be done here\n    },\n\n    // interface implementation\n    unregisterEvent(target, type, capture) {\n      // Nothing needs to be done here\n    },\n\n    /*\n    ---------------------------------------------------------------------------\n      FOCUS/BLUR USER INTERFACE\n    ---------------------------------------------------------------------------\n    */\n\n    /**\n     * Focuses the given DOM element\n     *\n     * @param element {Element} DOM element to focus\n     */\n    focus(element) {\n      // Fixed timing issue with IE, see [BUG #3267]\n      if (qx.core.Environment.get(\"engine.name\") == \"mshtml\") {\n        window.setTimeout(function () {\n          try {\n            // focus element before set cursor position\n            element.focus();\n\n            // Fixed cursor position issue with IE, only when nothing is selected.\n            // See [BUG #3519] for details.\n            var selection = qx.bom.Selection.get(element);\n            if (\n              selection.length == 0 &&\n              typeof element.createTextRange == \"function\"\n            ) {\n              var textRange = element.createTextRange();\n              textRange.moveStart(\"character\", element.value.length);\n              textRange.collapse();\n              textRange.select();\n            }\n          } catch (ex) {}\n        }, 0);\n      } else {\n        // Fix re-focusing on mousup event\n        // See https://github.com/qooxdoo/qooxdoo/issues/9393 and\n        // discussion in https://github.com/qooxdoo/qooxdoo/pull/9394\n        window.setTimeout(function () {\n          try {\n            element.focus();\n          } catch (ex) {}\n        }, 0);\n      }\n\n      this.setFocus(element);\n      this.setActive(element);\n    },\n\n    /**\n     * Activates the given DOM element\n     *\n     * @param element {Element} DOM element to activate\n     */\n    activate(element) {\n      this.setActive(element);\n    },\n\n    /**\n     * Blurs the given DOM element\n     *\n     * @param element {Element} DOM element to focus\n     */\n    blur(element) {\n      try {\n        element.blur();\n      } catch (ex) {}\n\n      if (this.getActive() === element) {\n        this.resetActive();\n      }\n\n      if (this.getFocus() === element) {\n        this.resetFocus();\n      }\n    },\n\n    /**\n     * Deactivates the given DOM element\n     *\n     * @param element {Element} DOM element to activate\n     */\n    deactivate(element) {\n      if (this.getActive() === element) {\n        this.resetActive();\n      }\n    },\n\n    /**\n     * Tries to activate the given element. This checks whether\n     * the activation is allowed first.\n     *\n     * @param element {Element} DOM element to activate\n     */\n    tryActivate(element) {\n      var active = this.__findActivatableElement(element);\n      if (active) {\n        this.setActive(active);\n      }\n    },\n\n    /*\n    ---------------------------------------------------------------------------\n      HELPER\n    ---------------------------------------------------------------------------\n    */\n\n    /**\n     * Shorthand to fire events from within this class.\n     *\n     * @param target {Element} DOM element which is the target\n     * @param related {Element} DOM element which is the related target\n     * @param type {String} Name of the event to fire\n     * @param bubbles {Boolean} Whether the event should bubble\n     * @return {qx.Promise?} a promise, if one or more of the event handlers returned a promise\n     */\n    __fireEvent(target, related, type, bubbles) {\n      var Registration = qx.event.Registration;\n\n      var evt = Registration.createEvent(type, qx.event.type.Focus, [\n        target,\n        related,\n        bubbles\n      ]);\n\n      return Registration.dispatchEvent(target, evt);\n    },\n\n    /*\n    ---------------------------------------------------------------------------\n      WINDOW FOCUS/BLUR SUPPORT\n    ---------------------------------------------------------------------------\n    */\n\n    /** @type {Boolean} Whether the window is focused currently */\n    _windowFocused: true,\n\n    /**\n     * Helper for native event listeners to react on window blur\n     */\n    __doWindowBlur() {\n      // Omit doubled blur events\n      // which is a common behavior at least for gecko based clients\n      if (this._windowFocused) {\n        this._windowFocused = false;\n        this.__fireEvent(this._window, null, \"blur\", false);\n      }\n    },\n\n    /**\n     * Helper for native event listeners to react on window focus\n     */\n    __doWindowFocus() {\n      // Omit doubled focus events\n      // which is a common behavior at least for gecko based clients\n      if (!this._windowFocused) {\n        this._windowFocused = true;\n        this.__fireEvent(this._window, null, \"focus\", false);\n      }\n    },\n\n    /*\n    ---------------------------------------------------------------------------\n      NATIVE OBSERVER\n    ---------------------------------------------------------------------------\n    */\n\n    /**\n     * Initializes event listeners.\n     *\n     * @signature function()\n     */\n    _initObserver: qx.core.Environment.select(\"engine.name\", {\n      gecko() {\n        // Bind methods\n        this.__onNativeMouseDownWrapper = qx.lang.Function.listener(\n          this.__onNativeMouseDown,\n          this\n        );\n\n        this.__onNativeMouseUpWrapper = qx.lang.Function.listener(\n          this.__onNativeMouseUp,\n          this\n        );\n\n        this.__onNativeFocusWrapper = qx.lang.Function.listener(\n          this.__onNativeFocus,\n          this\n        );\n\n        this.__onNativeBlurWrapper = qx.lang.Function.listener(\n          this.__onNativeBlur,\n          this\n        );\n\n        this.__onNativeDragGestureWrapper = qx.lang.Function.listener(\n          this.__onNativeDragGesture,\n          this\n        );\n\n        // Register events\n        qx.bom.Event.addNativeListener(\n          this._document,\n          \"mousedown\",\n          this.__onNativeMouseDownWrapper,\n          true\n        );\n\n        qx.bom.Event.addNativeListener(\n          this._document,\n          \"mouseup\",\n          this.__onNativeMouseUpWrapper,\n          true\n        );\n\n        // Capturing is needed for gecko to correctly\n        // handle focus of input and textarea fields\n        qx.bom.Event.addNativeListener(\n          this._window,\n          \"focus\",\n          this.__onNativeFocusWrapper,\n          true\n        );\n\n        qx.bom.Event.addNativeListener(\n          this._window,\n          \"blur\",\n          this.__onNativeBlurWrapper,\n          true\n        );\n\n        // Capture drag events\n        qx.bom.Event.addNativeListener(\n          this._window,\n          \"draggesture\",\n          this.__onNativeDragGestureWrapper,\n          true\n        );\n      },\n\n      mshtml() {\n        // Bind methods\n        this.__onNativeMouseDownWrapper = qx.lang.Function.listener(\n          this.__onNativeMouseDown,\n          this\n        );\n\n        this.__onNativeMouseUpWrapper = qx.lang.Function.listener(\n          this.__onNativeMouseUp,\n          this\n        );\n\n        this.__onNativeFocusInWrapper = qx.lang.Function.listener(\n          this.__onNativeFocusIn,\n          this\n        );\n\n        this.__onNativeFocusOutWrapper = qx.lang.Function.listener(\n          this.__onNativeFocusOut,\n          this\n        );\n\n        this.__onNativeSelectStartWrapper = qx.lang.Function.listener(\n          this.__onNativeSelectStart,\n          this\n        );\n\n        // Register events\n        qx.bom.Event.addNativeListener(\n          this._document,\n          \"mousedown\",\n          this.__onNativeMouseDownWrapper\n        );\n\n        qx.bom.Event.addNativeListener(\n          this._document,\n          \"mouseup\",\n          this.__onNativeMouseUpWrapper\n        );\n\n        // MSHTML supports their own focusin and focusout events\n        // To detect which elements get focus the target is useful\n        // The window blur can detected using focusout and look\n        // for the toTarget property which is empty in this case.\n        qx.bom.Event.addNativeListener(\n          this._document,\n          \"focusin\",\n          this.__onNativeFocusInWrapper\n        );\n\n        qx.bom.Event.addNativeListener(\n          this._document,\n          \"focusout\",\n          this.__onNativeFocusOutWrapper\n        );\n\n        // Add selectstart to prevent selection\n        qx.bom.Event.addNativeListener(\n          this._document,\n          \"selectstart\",\n          this.__onNativeSelectStartWrapper\n        );\n      },\n\n      webkit: qx.core.Environment.select(\"browser.name\", {\n        // fix for [ISSUE #9174]\n        // distinguish bettween MS Edge, which is reported\n        // as engine webkit and all other webkit browsers\n        edge(domEvent) {\n          // Bind methods\n          this.__onNativeMouseDownWrapper = qx.lang.Function.listener(\n            this.__onNativeMouseDown,\n            this\n          );\n\n          this.__onNativeMouseUpWrapper = qx.lang.Function.listener(\n            this.__onNativeMouseUp,\n            this\n          );\n\n          this.__onNativeFocusOutWrapper = qx.lang.Function.listener(\n            this.__onNativeFocusOut,\n            this\n          );\n\n          this.__onNativeFocusInWrapper = qx.lang.Function.listener(\n            this.__onNativeFocusIn,\n            this\n          );\n\n          this.__onNativeSelectStartWrapper = qx.lang.Function.listener(\n            this.__onNativeSelectStart,\n            this\n          );\n\n          // Register events\n          qx.bom.Event.addNativeListener(\n            this._document,\n            \"mousedown\",\n            this.__onNativeMouseDownWrapper,\n            true\n          );\n\n          qx.bom.Event.addNativeListener(\n            this._document,\n            \"mouseup\",\n            this.__onNativeMouseUpWrapper,\n            true\n          );\n\n          qx.bom.Event.addNativeListener(\n            this._document,\n            \"selectstart\",\n            this.__onNativeSelectStartWrapper,\n            false\n          );\n\n          qx.bom.Event.addNativeListener(\n            this._document,\n            \"focusin\",\n            this.__onNativeFocusInWrapper\n          );\n\n          qx.bom.Event.addNativeListener(\n            this._document,\n            \"focusout\",\n            this.__onNativeFocusOutWrapper\n          );\n        },\n\n        default(domEvent) {\n          // Bind methods\n          this.__onNativeMouseDownWrapper = qx.lang.Function.listener(\n            this.__onNativeMouseDown,\n            this\n          );\n\n          this.__onNativeMouseUpWrapper = qx.lang.Function.listener(\n            this.__onNativeMouseUp,\n            this\n          );\n\n          this.__onNativeFocusOutWrapper = qx.lang.Function.listener(\n            this.__onNativeFocusOut,\n            this\n          );\n\n          this.__onNativeFocusWrapper = qx.lang.Function.listener(\n            this.__onNativeFocus,\n            this\n          );\n\n          this.__onNativeBlurWrapper = qx.lang.Function.listener(\n            this.__onNativeBlur,\n            this\n          );\n\n          this.__onNativeSelectStartWrapper = qx.lang.Function.listener(\n            this.__onNativeSelectStart,\n            this\n          );\n\n          // Register events\n          qx.bom.Event.addNativeListener(\n            this._document,\n            \"mousedown\",\n            this.__onNativeMouseDownWrapper,\n            true\n          );\n\n          qx.bom.Event.addNativeListener(\n            this._document,\n            \"mouseup\",\n            this.__onNativeMouseUpWrapper,\n            true\n          );\n\n          qx.bom.Event.addNativeListener(\n            this._document,\n            \"selectstart\",\n            this.__onNativeSelectStartWrapper,\n            false\n          );\n\n          qx.bom.Event.addNativeListener(\n            this._window,\n            \"DOMFocusOut\",\n            this.__onNativeFocusOutWrapper,\n            true\n          );\n\n          qx.bom.Event.addNativeListener(\n            this._window,\n            \"focus\",\n            this.__onNativeFocusWrapper,\n            true\n          );\n\n          qx.bom.Event.addNativeListener(\n            this._window,\n            \"blur\",\n            this.__onNativeBlurWrapper,\n            true\n          );\n        }\n      }),\n\n      opera() {\n        // Bind methods\n        this.__onNativeMouseDownWrapper = qx.lang.Function.listener(\n          this.__onNativeMouseDown,\n          this\n        );\n\n        this.__onNativeMouseUpWrapper = qx.lang.Function.listener(\n          this.__onNativeMouseUp,\n          this\n        );\n\n        this.__onNativeFocusInWrapper = qx.lang.Function.listener(\n          this.__onNativeFocusIn,\n          this\n        );\n\n        this.__onNativeFocusOutWrapper = qx.lang.Function.listener(\n          this.__onNativeFocusOut,\n          this\n        );\n\n        // Register events\n        qx.bom.Event.addNativeListener(\n          this._document,\n          \"mousedown\",\n          this.__onNativeMouseDownWrapper,\n          true\n        );\n\n        qx.bom.Event.addNativeListener(\n          this._document,\n          \"mouseup\",\n          this.__onNativeMouseUpWrapper,\n          true\n        );\n\n        qx.bom.Event.addNativeListener(\n          this._window,\n          \"DOMFocusIn\",\n          this.__onNativeFocusInWrapper,\n          true\n        );\n\n        qx.bom.Event.addNativeListener(\n          this._window,\n          \"DOMFocusOut\",\n          this.__onNativeFocusOutWrapper,\n          true\n        );\n      }\n    }),\n\n    /**\n     * Disconnects event listeners.\n     *\n     * @signature function()\n     */\n    _stopObserver: qx.core.Environment.select(\"engine.name\", {\n      gecko() {\n        qx.bom.Event.removeNativeListener(\n          this._document,\n          \"mousedown\",\n          this.__onNativeMouseDownWrapper,\n          true\n        );\n\n        qx.bom.Event.removeNativeListener(\n          this._document,\n          \"mouseup\",\n          this.__onNativeMouseUpWrapper,\n          true\n        );\n\n        qx.bom.Event.removeNativeListener(\n          this._window,\n          \"focus\",\n          this.__onNativeFocusWrapper,\n          true\n        );\n\n        qx.bom.Event.removeNativeListener(\n          this._window,\n          \"blur\",\n          this.__onNativeBlurWrapper,\n          true\n        );\n\n        qx.bom.Event.removeNativeListener(\n          this._window,\n          \"draggesture\",\n          this.__onNativeDragGestureWrapper,\n          true\n        );\n      },\n\n      mshtml() {\n        qx.bom.Event.removeNativeListener(\n          this._document,\n          \"mousedown\",\n          this.__onNativeMouseDownWrapper\n        );\n\n        qx.bom.Event.removeNativeListener(\n          this._document,\n          \"mouseup\",\n          this.__onNativeMouseUpWrapper\n        );\n\n        qx.bom.Event.removeNativeListener(\n          this._document,\n          \"focusin\",\n          this.__onNativeFocusInWrapper\n        );\n\n        qx.bom.Event.removeNativeListener(\n          this._document,\n          \"focusout\",\n          this.__onNativeFocusOutWrapper\n        );\n\n        qx.bom.Event.removeNativeListener(\n          this._document,\n          \"selectstart\",\n          this.__onNativeSelectStartWrapper\n        );\n      },\n\n      webkit: qx.core.Environment.select(\"browser.name\", {\n        // fix for [ISSUE #9174]\n        // distinguish bettween MS Edge, which is reported\n        // as engine webkit and all other webkit browsers\n        edge() {\n          qx.bom.Event.removeNativeListener(\n            this._document,\n            \"mousedown\",\n            this.__onNativeMouseDownWrapper\n          );\n\n          qx.bom.Event.removeNativeListener(\n            this._document,\n            \"mouseup\",\n            this.__onNativeMouseUpWrapper\n          );\n\n          qx.bom.Event.removeNativeListener(\n            this._document,\n            \"focusin\",\n            this.__onNativeFocusInWrapper\n          );\n\n          qx.bom.Event.removeNativeListener(\n            this._document,\n            \"focusout\",\n            this.__onNativeFocusOutWrapper\n          );\n\n          qx.bom.Event.removeNativeListener(\n            this._document,\n            \"selectstart\",\n            this.__onNativeSelectStartWrapper\n          );\n        },\n\n        default() {\n          qx.bom.Event.removeNativeListener(\n            this._document,\n            \"mousedown\",\n            this.__onNativeMouseDownWrapper,\n            true\n          );\n\n          qx.bom.Event.removeNativeListener(\n            this._document,\n            \"mouseup\",\n            this.__onNativeMouseUpWrapper,\n            true\n          );\n\n          qx.bom.Event.removeNativeListener(\n            this._document,\n            \"selectstart\",\n            this.__onNativeSelectStartWrapper,\n            false\n          );\n\n          qx.bom.Event.removeNativeListener(\n            this._window,\n            \"DOMFocusOut\",\n            this.__onNativeFocusOutWrapper,\n            true\n          );\n\n          qx.bom.Event.removeNativeListener(\n            this._window,\n            \"focus\",\n            this.__onNativeFocusWrapper,\n            true\n          );\n\n          qx.bom.Event.removeNativeListener(\n            this._window,\n            \"blur\",\n            this.__onNativeBlurWrapper,\n            true\n          );\n        }\n      }),\n\n      opera() {\n        qx.bom.Event.removeNativeListener(\n          this._document,\n          \"mousedown\",\n          this.__onNativeMouseDownWrapper,\n          true\n        );\n\n        qx.bom.Event.removeNativeListener(\n          this._document,\n          \"mouseup\",\n          this.__onNativeMouseUpWrapper,\n          true\n        );\n\n        qx.bom.Event.removeNativeListener(\n          this._window,\n          \"DOMFocusIn\",\n          this.__onNativeFocusInWrapper,\n          true\n        );\n\n        qx.bom.Event.removeNativeListener(\n          this._window,\n          \"DOMFocusOut\",\n          this.__onNativeFocusOutWrapper,\n          true\n        );\n      }\n    }),\n\n    /*\n    ---------------------------------------------------------------------------\n      NATIVE LISTENERS\n    ---------------------------------------------------------------------------\n    */\n\n    /**\n     * Native event listener for <code>draggesture</code> event\n     * supported by gecko. Used to stop native drag and drop when\n     * selection is disabled.\n     *\n     * @see https://developer.mozilla.org/en-US/docs/Drag_and_Drop\n     * @signature function(domEvent)\n     * @param domEvent {Event} Native event\n     */\n    __onNativeDragGesture: qx.event.GlobalError.observeMethod(\n      qx.core.Environment.select(\"engine.name\", {\n        gecko(domEvent) {\n          var target = qx.bom.Event.getTarget(domEvent);\n          if (!this.__isSelectable(target)) {\n            qx.bom.Event.preventDefault(domEvent);\n          }\n        },\n\n        default: null\n      })\n    ),\n\n    /**\n     * Native event listener for <code>DOMFocusIn</code> or <code>focusin</code>\n     * depending on the client's engine.\n     *\n     * @signature function(domEvent)\n     * @param domEvent {Event} Native event\n     */\n    __onNativeFocusIn: qx.event.GlobalError.observeMethod(\n      qx.core.Environment.select(\"engine.name\", {\n        mshtml(domEvent) {\n          // Force window focus to be the first\n          this.__doWindowFocus();\n\n          // Update internal data\n          var target = qx.bom.Event.getTarget(domEvent);\n\n          // IE focusin is also fired on elements which are not focusable at all\n          // We need to look up for the next focusable element.\n          var focusTarget = this.__findFocusableElement(target);\n          if (focusTarget) {\n            this.setFocus(focusTarget);\n          }\n\n          // Make target active\n          this.tryActivate(target);\n        },\n\n        webkit: qx.core.Environment.select(\"browser.name\", {\n          // fix for [ISSUE #9174]\n          // distinguish bettween MS Edge, which is reported\n          // as engine webkit and all other webkit browsers\n          edge(domEvent) {\n            // Force window focus to be the first\n            this.__doWindowFocus();\n\n            // Update internal data\n            var target = qx.bom.Event.getTarget(domEvent);\n\n            // IE focusin is also fired on elements which are not focusable at all\n            // We need to look up for the next focusable element.\n            var focusTarget = this.__findFocusableElement(target);\n            if (focusTarget) {\n              this.setFocus(focusTarget);\n            }\n\n            // Make target active\n            this.tryActivate(target);\n          },\n\n          default: null\n        }),\n\n        opera(domEvent) {\n          var target = qx.bom.Event.getTarget(domEvent);\n          if (target == this._document || target == this._window) {\n            this.__doWindowFocus();\n\n            if (this.__previousFocus) {\n              this.setFocus(this.__previousFocus);\n              delete this.__previousFocus;\n            }\n\n            if (this.__previousActive) {\n              this.setActive(this.__previousActive);\n              delete this.__previousActive;\n            }\n          } else {\n            this.setFocus(target);\n            this.tryActivate(target);\n\n            // Clear selection\n            if (!this.__isSelectable(target)) {\n              target.selectionStart = 0;\n              target.selectionEnd = 0;\n            }\n          }\n        },\n\n        default: null\n      })\n    ),\n\n    /**\n     * Native event listener for <code>DOMFocusOut</code> or <code>focusout</code>\n     * depending on the client's engine.\n     *\n     * @signature function(domEvent)\n     * @param domEvent {Event} Native event\n     */\n    __onNativeFocusOut: qx.event.GlobalError.observeMethod(\n      qx.core.Environment.select(\"engine.name\", {\n        mshtml(domEvent) {\n          var relatedTarget = qx.bom.Event.getRelatedTarget(domEvent);\n\n          // If the focus goes to nowhere (the document is blurred)\n          if (relatedTarget == null) {\n            // Update internal representation\n            this.__doWindowBlur();\n\n            // Reset active and focus\n            this.resetFocus();\n            this.resetActive();\n          }\n        },\n\n        webkit: qx.core.Environment.select(\"browser.name\", {\n          // fix for [ISSUE #9174]\n          // distinguish bettween MS Edge, which is reported\n          // as engine webkit and all other webkit browsers\n          edge(domEvent) {\n            var relatedTarget = qx.bom.Event.getRelatedTarget(domEvent);\n\n            // If the focus goes to nowhere (the document is blurred)\n            if (relatedTarget == null) {\n              // Update internal representation\n              this.__doWindowBlur();\n\n              // Reset active and focus\n              this.resetFocus();\n              this.resetActive();\n            }\n          },\n\n          default(domEvent) {\n            var target = qx.bom.Event.getTarget(domEvent);\n\n            if (target === this.getFocus()) {\n              this.resetFocus();\n            }\n\n            if (target === this.getActive()) {\n              this.resetActive();\n            }\n          }\n        }),\n\n        opera(domEvent) {\n          var target = qx.bom.Event.getTarget(domEvent);\n          if (target == this._document) {\n            this.__doWindowBlur();\n\n            // Store old focus/active elements\n            // Opera do not fire focus events for them\n            // when refocussing the window (in my opinion an error)\n            this.__previousFocus = this.getFocus();\n            this.__previousActive = this.getActive();\n\n            this.resetFocus();\n            this.resetActive();\n          } else {\n            if (target === this.getFocus()) {\n              this.resetFocus();\n            }\n\n            if (target === this.getActive()) {\n              this.resetActive();\n            }\n          }\n        },\n\n        default: null\n      })\n    ),\n\n    /**\n     * Native event listener for <code>blur</code>.\n     *\n     * @signature function(domEvent)\n     * @param domEvent {Event} Native event\n     */\n    __onNativeBlur: qx.event.GlobalError.observeMethod(\n      qx.core.Environment.select(\"engine.name\", {\n        gecko(domEvent) {\n          var target = qx.bom.Event.getTarget(domEvent);\n          if (target === this._window || target === this._document) {\n            this.__doWindowBlur();\n\n            this.resetActive();\n            this.resetFocus();\n          }\n        },\n\n        webkit(domEvent) {\n          var target = qx.bom.Event.getTarget(domEvent);\n          if (target === this._window || target === this._document) {\n            this.__doWindowBlur();\n\n            // Store old focus/active elements\n            // Opera do not fire focus events for them\n            // when refocussing the window (in my opinion an error)\n            this.__previousFocus = this.getFocus();\n            this.__previousActive = this.getActive();\n\n            this.resetActive();\n            this.resetFocus();\n          }\n        },\n\n        default: null\n      })\n    ),\n\n    /**\n     * Native event listener for <code>focus</code>.\n     *\n     * @signature function(domEvent)\n     * @param domEvent {Event} Native event\n     */\n    __onNativeFocus: qx.event.GlobalError.observeMethod(\n      qx.core.Environment.select(\"engine.name\", {\n        gecko(domEvent) {\n          var target = qx.bom.Event.getTarget(domEvent);\n\n          if (target === this._window || target === this._document) {\n            this.__doWindowFocus();\n\n            // Always speak of the body, not the window or document\n            target = this._body;\n          }\n\n          this.setFocus(target);\n          this.tryActivate(target);\n        },\n\n        webkit(domEvent) {\n          var target = qx.bom.Event.getTarget(domEvent);\n          if (target === this._window || target === this._document) {\n            this.__doWindowFocus();\n\n            if (this.__previousFocus) {\n              this.setFocus(this.__previousFocus);\n              delete this.__previousFocus;\n            }\n\n            if (this.__previousActive) {\n              this.setActive(this.__previousActive);\n              delete this.__previousActive;\n            }\n          } else {\n            this.__relatedTarget = domEvent.relatedTarget;\n            this.setFocus(target);\n            this.__relatedTarget = null;\n            this.tryActivate(target);\n          }\n        },\n\n        default: null\n      })\n    ),\n\n    /**\n     * Native event listener for <code>mousedown</code>.\n     *\n     * @signature function(domEvent)\n     * @param domEvent {Event} Native event\n     */\n    __onNativeMouseDown: qx.event.GlobalError.observeMethod(\n      qx.core.Environment.select(\"engine.name\", {\n        mshtml(domEvent) {\n          var target = qx.bom.Event.getTarget(domEvent);\n\n          // Stop events when no focus element available (or blocked)\n          var focusTarget = this.__findFocusableElement(target);\n          if (focusTarget) {\n            // Add unselectable to keep selection\n            if (!this.__isSelectable(target)) {\n              // The element is not selectable. Block selection.\n              target.unselectable = \"on\";\n\n              // Unselectable may keep the current selection which\n              // is not what we like when changing the focus element.\n              // So we clear it\n              try {\n                if (document.selection) {\n                  document.selection.empty();\n                }\n              } catch (ex) {\n                // ignore 'Unknown runtime error'\n              }\n\n              // The unselectable attribute stops focussing as well.\n              // Do this manually.\n              try {\n                focusTarget.focus();\n              } catch (ex) {\n                // ignore \"Can't move focus of this control\" error\n              }\n            }\n          } else {\n            // Stop event for blocking support\n            qx.bom.Event.preventDefault(domEvent);\n\n            // Add unselectable to keep selection\n            if (!this.__isSelectable(target)) {\n              target.unselectable = \"on\";\n            }\n          }\n        },\n\n        webkit(domEvent) {\n          var target = qx.bom.Event.getTarget(domEvent);\n          var focusTarget = this.__findFocusableElement(target);\n\n          if (focusTarget) {\n            this.setFocus(focusTarget);\n          } else {\n            qx.bom.Event.preventDefault(domEvent);\n          }\n        },\n\n        gecko(domEvent) {\n          var target = qx.bom.Event.getTarget(domEvent);\n          var focusTarget = this.__findFocusableElement(target);\n\n          if (focusTarget) {\n            this.setFocus(focusTarget);\n          } else {\n            qx.bom.Event.preventDefault(domEvent);\n          }\n        },\n\n        opera(domEvent) {\n          var target = qx.bom.Event.getTarget(domEvent);\n          var focusTarget = this.__findFocusableElement(target);\n\n          if (!this.__isSelectable(target)) {\n            // Prevent the default action for all non-selectable\n            // targets. This prevents text selection and context menu.\n            qx.bom.Event.preventDefault(domEvent);\n\n            // The stopped event keeps the selection\n            // of the previously focused element.\n            // We need to clear the old selection.\n            if (focusTarget) {\n              var current = this.getFocus();\n              if (current && current.selectionEnd) {\n                current.selectionStart = 0;\n                current.selectionEnd = 0;\n                current.blur();\n              }\n\n              // The prevented event also stop the focus, do\n              // it manually if needed.\n              if (focusTarget) {\n                this.setFocus(focusTarget);\n              }\n            }\n          } else if (focusTarget) {\n            this.setFocus(focusTarget);\n          }\n        },\n\n        default: null\n      })\n    ),\n\n    /**\n     * Native event listener for <code>mouseup</code>.\n     *\n     * @signature function(domEvent)\n     * @param domEvent {Event} Native event\n     */\n    __onNativeMouseUp: qx.event.GlobalError.observeMethod(\n      qx.core.Environment.select(\"engine.name\", {\n        mshtml(domEvent) {\n          var target = qx.bom.Event.getTarget(domEvent);\n          if (target.unselectable) {\n            target.unselectable = \"off\";\n          }\n\n          this.tryActivate(this.__fixFocus(target));\n        },\n\n        gecko(domEvent) {\n          // As of Firefox 3.0:\n          // Gecko fires mouseup on XUL elements\n          // We only want to deal with real HTML elements\n          var target = qx.bom.Event.getTarget(domEvent);\n          while (target && target.offsetWidth === undefined) {\n            target = target.parentNode;\n          }\n\n          if (target) {\n            this.tryActivate(target);\n          }\n        },\n\n        webkit(domEvent) {\n          var target = qx.bom.Event.getTarget(domEvent);\n          this.tryActivate(this.__fixFocus(target));\n        },\n\n        opera(domEvent) {\n          var target = qx.bom.Event.getTarget(domEvent);\n          this.tryActivate(this.__fixFocus(target));\n        },\n\n        default: null\n      })\n    ),\n\n    /**\n     * Fix for bug #9331.\n     *\n     * @signature function(target)\n     * @param target {Element} element to check\n     * @return {Element} return correct target (in case of compound input controls should always return textfield);\n     */\n    __getCorrectFocusTarget(target) {\n      var focusedElement = this.getFocus();\n      if (focusedElement && target != focusedElement) {\n        if (\n          focusedElement.nodeName.toLowerCase() === \"input\" ||\n          focusedElement.nodeName.toLowerCase() === \"textarea\"\n        ) {\n          return focusedElement;\n        }\n        if (qx.Class.isClass(\"qx.ui.core.Widget\")) {\n          // Check compound widgets\n          var widget = qx.ui.core.Widget.getWidgetByElement(focusedElement),\n            textField =\n              widget &&\n              widget.getChildControl &&\n              widget.getChildControl(\"textfield\", true);\n        }\n        if (textField) {\n          return textField.getContentElement().getDomElement();\n        }\n      }\n      return target;\n    },\n\n    /**\n     * Fix for bug #2602.\n     *\n     * @signature function(target)\n     * @param target {Element} target element from mouse up event\n     * @return {Element} Element to activate;\n     */\n    __fixFocus: qx.event.GlobalError.observeMethod(\n      qx.core.Environment.select(\"engine.name\", {\n        mshtml(target) {\n          return this.__getCorrectFocusTarget(target);\n        },\n\n        webkit(target) {\n          return this.__getCorrectFocusTarget(target);\n        },\n\n        default(target) {\n          return target;\n        }\n      })\n    ),\n\n    /**\n     * Native event listener for <code>selectstart</code>.\n     *\n     *@signature function(domEvent)\n     * @param domEvent {Event} Native event\n     */\n    __onNativeSelectStart: qx.event.GlobalError.observeMethod(\n      qx.core.Environment.select(\"engine.name\", {\n        mshtml(domEvent) {\n          var target = qx.bom.Event.getTarget(domEvent);\n          if (!this.__isSelectable(target)) {\n            qx.bom.Event.preventDefault(domEvent);\n          }\n        },\n\n        webkit(domEvent) {\n          var target = qx.bom.Event.getTarget(domEvent);\n          if (!this.__isSelectable(target)) {\n            qx.bom.Event.preventDefault(domEvent);\n          }\n        },\n\n        default: null\n      })\n    ),\n\n    /*\n    ---------------------------------------------------------------------------\n      HELPER METHODS\n    ---------------------------------------------------------------------------\n    */\n\n    /**\n     * Whether the given element is focusable. This is perfectly modeled to the\n     * browsers behavior and this way may differ in the various clients.\n     *\n     * @param el {Element} DOM Element to query\n     * @return {Boolean} Whether the element is focusable\n     */\n    __isFocusable(el) {\n      var index = qx.bom.element.Attribute.get(el, \"tabIndex\");\n      if (index >= 1) {\n        return true;\n      }\n\n      var focusable = qx.event.handler.Focus.FOCUSABLE_ELEMENTS;\n      if (index >= 0 && focusable[el.tagName]) {\n        return true;\n      }\n\n      return false;\n    },\n\n    /**\n     * Returns the next focusable parent element of an activated DOM element.\n     *\n     * @param el {Element} Element to start lookup with.\n     * @return {Element|null} The next focusable element.\n     */\n    __findFocusableElement(el) {\n      while (el && el.nodeType === 1) {\n        if (el.getAttribute(\"qxKeepFocus\") == \"on\") {\n          return null;\n        }\n\n        if (this.__isFocusable(el)) {\n          return el;\n        }\n\n        el = el.parentNode;\n      }\n\n      // This should be identical to the one which is selected when\n      // clicking into an empty page area. In mshtml this must be\n      // the body of the document.\n      return this._body;\n    },\n\n    /**\n     * Returns the next activatable element. May be the element itself.\n     * Works a bit different than the method {@link #__findFocusableElement}\n     * as it looks up for a parent which is has a keep focus flag. When\n     * there is such a parent it returns null otherwise the original\n     * incoming element.\n     *\n     * @param el {Element} Element to start lookup with.\n     * @return {Element} The next activatable element.\n     */\n    __findActivatableElement(el) {\n      var orig = el;\n\n      while (el && el.nodeType === 1) {\n        if (el.getAttribute(\"qxKeepActive\") == \"on\") {\n          return null;\n        }\n\n        el = el.parentNode;\n      }\n\n      return orig;\n    },\n\n    /**\n     * Whether the given el (or its content) should be selectable\n     * by the user.\n     *\n     * @param node {Element} Node to start lookup with\n     * @return {Boolean} Whether the content is selectable.\n     */\n    __isSelectable(node) {\n      while (node && node.nodeType === 1) {\n        var attr = node.getAttribute(\"qxSelectable\");\n        if (attr != null) {\n          return attr === \"on\";\n        }\n\n        node = node.parentNode;\n      }\n\n      return true;\n    },\n\n    /*\n    ---------------------------------------------------------------------------\n      PROPERTY APPLY ROUTINES\n    ---------------------------------------------------------------------------\n    */\n\n    // apply routine\n    _applyActive(value, old) {\n      // Fire events\n      if (old) {\n        this.__fireEvent(old, value, \"deactivate\", true);\n      }\n\n      if (value) {\n        this.__fireEvent(value, old, \"activate\", true);\n      }\n      // correct scroll position for iOS 7\n      if (this.__needsScrollFix) {\n        window.scrollTo(0, 0);\n      }\n    },\n\n    // apply routine\n    _applyFocus(value, old) {\n      // Fire bubbling events\n      if (old) {\n        this.__fireEvent(old, value, \"focusout\", true);\n      }\n\n      if (value) {\n        this.__fireEvent(value, old, \"focusin\", true);\n      }\n\n      // Fire after events\n      if (old) {\n        this.__fireEvent(old, value, \"blur\", false);\n      }\n\n      if (value) {\n        this.__fireEvent(value, old || this.__relatedTarget, \"focus\", false);\n      }\n    }\n  },\n\n  /*\n  *****************************************************************************\n     DESTRUCTOR\n  *****************************************************************************\n  */\n\n  destruct() {\n    this._stopObserver();\n    this._manager =\n      this._window =\n      this._document =\n      this._root =\n      this._body =\n      this.__mouseActive =\n      this.__relatedTarget =\n        null;\n  },\n\n  /*\n  *****************************************************************************\n     DEFER\n  *****************************************************************************\n  */\n\n  defer(statics) {\n    qx.event.Registration.addHandler(statics);\n\n    // For faster lookups generate uppercase tag names dynamically\n    var focusable = statics.FOCUSABLE_ELEMENTS;\n    for (var entry in focusable) {\n      focusable[entry.toUpperCase()] = 1;\n    }\n  }\n});\n"
  ]
}